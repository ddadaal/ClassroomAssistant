# 课程教学辅助系统 评估文档

By 五律协同观乙方

| 成员学号  | 成员姓名 |
| --------- | -------- |
| 161250010 | 陈俊达   |
| 161250011 | 陈俊宇   |
| 161250091 | 苗沐之   |
| 161250050 | 靳炳淑   |
| 161250103 | 钱宇辰   |
| 161250068 | 廖均达   |
| 161250056 | 李冰     |
| 161250067 | 梁楠     |

# 0. 目录

# 0.1业务驱动

| 业务驱动 | 内容                                                         |
| -------- | ------------------------------------------------------------ |
| 用户购票 | 用户可以在平台上选择影院或电影查看上映，然后对电影进行选票的操作 |
| 发表评论 | 用户可以在观影完成后对电影进行评分和评论操作                 |
| 回复评论 | 用户可以看到其他用户的评分和评论，并可以对其他用户的评论进行评论、或者“顶/踩”操作 |
| 账户管理 | 用户可以设置个人信息，包括昵称、手机号、密码、感兴趣电影类型等信息 |
| 订单管理 | 用户可以对已经购买的电影订单进行查看、退票、改签等操作       |
| 报表查看 | 管理员可以查看每部电影的销售情况或者每个影院每次放映的的上座率，用户画像等资料 |
| 电影管理 | 管理员可以对电影进行上架和下架等操作                         |
| 拍片管理 | 电影院的管理员可以基于系统的已有电影进行其电影院的排片操作，同时本系统和其他电影院的系统进行同步座位、价格和场次情况 |

# 1. 质量属性效用树

| 质量属性 | 具体属性 | 场景 |
| -------- | -------- | ---- |
|安全性|数据安全|A1：攻击者获得数据库数据后,无法解析加密后的数据[中, 中]|
|安全性|权限控制|A2：系统在2秒内拒绝未验证用户的购票操作[高, 中]|
|可用性|服务可用性|A3: 系统及时发现服务器出现故障，无法正常运行的情况 (高，中)|
|可用性|错误检测|A4：系统在 1s 内发现用户断线 (中，高)|
|鲁棒性|错误操作处理|A5：系统在 2s 内发现用户错误操作并给出提示信息 (高，高)|
|性能|并发性|A6:系统在 2s 内发现用户错误操作并给出提示信息 (高，高)|
|性能|响应速度|A7:|
|可靠性|数据完整性|A8:|
|可扩展性|服务更新|A9:|


# 2. ATAM分析

<table>
	<tr>
		<th>场景A1</th>
		<th colspan='4'>攻击者获得数据库数据后,无法解析加密后的数据</th>
	</tr>
	<tr>
		<td>质量属性</td>
		<td colspan='4'>安全性</td>
	</tr>
	<tr>
		<td>环境</td>
		<td colspan='4'>系统运⾏环境，系统正常运行;或者系统整体测试时</td>
	</tr>
	<tr>
		<td>刺激</td>
		<td colspan='4'>数据库数据被窃取</td>
	</tr>
	<tr>
		<td>响应</td>
		<td colspan='4'>1. 系统发现用户断线时，记录断线信息<br>2. 当用户重连时恢复用户断线前的现场信息</td>
	</tr>
	<tr>
			<th>架构决策</th>
			<th>敏感点</th>
			<th>权衡点</th>
			<th>风险</th>
			<th>非风险</th>
	</tr>
	<tr>
		<td>ping/echo机制</td>
		<td>S4</td>
		<td></td>
		<td></td>
		<td>N4</td>
	</tr>
	<tr>
		<td>出错重试</td>
		<td></td>
		<td>T4</td>
		<td>R2</td>
		<td></td>
	</tr>
	<tr>
		<td>理由说明</td>
		<td colspan='4'>通过ping/echo的检测机制,系统能够尽早发现连接异常,并采取出错重试的恢复措施</td>
	</tr>
	<tr>
		<td>相关架构图</td>
		<td colspan='4'><img src='img/A4.png'></img></td>
	</tr>
</table>

<table>
	<tr>
		<th>场景A2</th>
		<th colspan='4'>系统在2秒内拒绝未验证用户的购票操作</th>
	</tr>
	<tr>
		<td>质量属性</td>
		<td colspan='4'>安全性</td>
	</tr>
	<tr>
		<td>环境</td>
		<td colspan='4'>整体系统正常运行</td>
	</tr>
	<tr>
		<td>刺激</td>
		<td colspan='4'>用户断线</td>
	</tr>
	<tr>
		<td>响应</td>
		<td colspan='4'>1. 系统发现用户断线时，记录断线信息<br/>2. 当用户重连时恢复用户断线前的现场信息</td>
	</tr>
	<tr>
			<th>架构决策</th>
			<th>敏感点</th>
			<th>权衡点</th>
			<th>风险</th>
			<th>非风险</th>
	</tr>
	<tr>
		<td>ping/echo机制</td>
		<td>S4</td>
		<td></td>
		<td></td>
		<td>N4</td>
	</tr>
	<tr>
		<td>出错重试</td>
		<td></td>
		<td>T4</td>
		<td>R2</td>
		<td></td>
	</tr>
	<tr>
		<td>理由说明</td>
		<td colspan='4'>通过ping/echo的检测机制,系统能够尽早发现连接异常,并采取出错重试的恢复措施</td>
	</tr>
	<tr>
		<td>相关架构图</td>
		<td colspan='4'><img src='img/A4.png'></img></td>
	</tr>
</table>
<table>
	<tr>
		<th>场景A3</th>
		<th colspan='4'>系统及时发现服务器出现故障，无法正常运行的情况</th>
	</tr>
	<tr>
		<td>质量属性</td>
		<td colspan='4'>可用性</td>
	</tr>
	<tr>
		<td>环境</td>
		<td colspan='4'>系统服务器出现故障，⽆法正常运⾏</td>
	</tr>
	<tr>
		<td>刺激</td>
		<td colspan='4'系统服务器崩溃，⽆法提供服务</td>
	</tr>
	<tr>
		<td>响应</td>
		<td colspan='4'>1. 查明服务器故障原因，修复系统故障<br/>2. 记录并保存故障⽇志<br/>3. 通知访问的⽤户相应的功能暂时⽆法使⽤<br/>4. 解决问题并重启服务器</td>
	</tr>
	<tr>
			<th>架构决策</th>
			<th>敏感点</th>
			<th>权衡点</th>
			<th>风险</th>
			<th>非风险</th>
	</tr>
	<tr>
		<td>Ping/Echo</td>
		<td>ping/echo 只能测试客户端和服务器之间的网络连接是否正常，而不能检测服务器的某些功能是否正常运行，有可能出现 ping/echo 正常但是服务器的某些特定服务不正常</td>
		<td>ping 的频率决定了发现服务器故障的时间，高频率能够更快发现服务器宕机，但同样也增加了客户端和服务器的处理负担，需要对频率进行权衡</td>
		<td></td>
		<td>ping/echo 实现简单，有成熟的解决方案</td>
	</tr>
	<tr>
		<td>理由说明</td>
		<td colspan='4'>1. 在分布式环境下，服务节点⼀般会很多，所以根据概率⽽⾔，宕机少部分服务器对⽤户和整个系统的服务⽽⾔⼀般影响不⼤</br>2. 监控中⼼需要对⼤量的服务器进⾏监控，所以资源消耗对监控模块⽽⾔⾄关重要，Ping/Echo 消耗较小</td>
	</tr>
	<tr>
		<td>相关架构图</td>
		<td colspan='4'><img src='img/A3.png'></img></td>
	</tr>
</table>

<table>
	<tr>
		<th>场景A4</th>
		<th colspan='4'>系统在 1s 内发现用户断线</th>
	</tr>
	<tr>
		<td>质量属性</td>
		<td colspan='4'>可用性</td>
	</tr>
	<tr>
		<td>环境</td>
		<td colspan='4'>客户端软件在⽆⽹络或⽹络不稳定的环境下运⾏</td>
	</tr>
	<tr>
		<td>刺激</td>
		<td colspan='4'>⽹络不稳定或失去连接</td>
	</tr>
	<tr>
		<td>响应</td>
		<td colspan='4'>1. 在 0.5s 内保存⽤户的操作和相应的信息<br/>2. 在断线发生后 1s 内告知⽤户⽹络存在问题<br/>3. 检测到⽹络连接状况良好时，在1s内重新进⾏操作</td>
	</tr>
	<tr>
			<th>架构决策</th>
			<th>敏感点</th>
			<th>权衡点</th>
			<th>风险</th>
			<th>非风险</th>
	</tr>
	<tr>
		<td>Heartbeat</td>
		<td>发送心跳的频率会影响发现用户断线时间</td>
		<td>发送心跳的频率决定了发现用户断线的时间。高频率能够更快发现断线但同时也增加了服务器的负担，这是需要进行权衡的地方</td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>理由说明</td>
		<td colspan='4'>心跳检测的通信负担比 ping/echo 的通信负担更小</td>
	</tr>
	<tr>
		<td>相关架构图</td>
		<td colspan='4'><img src='img/A4.png'></img></td>
	</tr>
</table>



# 3. 敏感点

|#|架构决策|原因|
|-|-|-|
|S1|限制数据库访问权限|安全性和性能的敏感点。保证数据未被纂改，可能会带来性能上的开销。|
|S2|用户执行操作前验证权限|安全性和性能的敏感点。每次操作前需要进行验证，会带来性能上的开销。|
| S3   | 使用热备份与实时负载均衡服务器提供备用服务 | 热备份与实时负载均衡服务器可以避免服务器意外宕机引起服务不可用，是系统服务可用性的敏感点，用户访问服务额外经过负载均衡服务器会影响总体响应时间，可能提升服务速度，但也会多一次访问请求，也是性能的敏感点。 |
|S4|ping/echo机制|可用性的敏感点<br>用来检测服务的状态|


# 4. 权衡点
|#|架构决策|原因|
|-|-|-|
|T1|限制数据库访问权限|安全性和性能的权衡点。牺牲部分安全性，保证性能。|
|T2|用户执行操作前验证权限|安全性和性能的权衡点。牺牲部分安全性，保证性能。|
| T3   | 使用热备份与实时负载均衡服务器提供备用服务 | 增加实时负载均衡服务器改善服务提供但增加访问次数，是可用性与性能的权衡点。 |
|T4|出错重试|可用性与效率的权衡点<br>出错后立刻尝试重连可以避免偶然错误,但增加系统负载|

# 5. 风险

|#|架构决策|原因|
|-|-|-|
|R1|限制数据库访问权限|数据库可能被暴力破解。|
|R2|出错重试|出错重试会增加系统负载,降低效率|

# 6. 非风险

|#|架构决策|原因|
|-|-|-|
|N1|限制数据库访问权限|大部分数据库均提供权限验证的功能。|
|N2|用户执行操作前验证权限|将操作分为不同等级，验证高等级操作|
| N3  | 使用热备份与实时负载均衡服务器提供备用服务 | 增加这些模块会改善可用性，而少量增加系统运行金钱成本。采用决策可以自建服务器或购买相关服务。 |
|N4|ping/echo机制|ping/echo机制实现简单,且已有成熟的解决方案|

